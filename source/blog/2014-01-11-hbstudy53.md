---
title: hbstudy 53に参加
published: true
---

分散ストレージ、S3互換に引かれてhbstudy53に参加してきました。S3cmd使ったのが初
めてなので良い経験となりました。自宅でも構築してみたいですが3ノード準備するのが
手間ですね。1台のサーバにノードを同居させることも可能みたいですが。

以下メモ。

## sucedule

* 分散ストレージ構築　苦労話
* ハンズオン
* bashoの方のお話

## 苦労苦労話

* riak   kvs
* riakcs  ストレージ
* 3つのノードに書く
* バケットとハッシュ値をもとに書き込むサーバを決めてる
* 1台故障しても大丈夫
* 2個壊れるとめんい？？？
* 書き込みのときも2台壊れて大丈夫
* handoffという機能
* サーバ復旧後、本来の位置に書き込む
* スケールアウトのためにサーバ追加すると自動で配置、もちろん無停止
* データの自動復旧 active anti-entropy
* raidのscrubのような機能

* riak cs
* riak上で動作するアプリケーション
* riak csがデータを分割し(1mb)、riakへ書き込む

* 待たされるとき
* 10tbの負荷試験
* 障害試験
* ローリングアップデート

* 分からないとき
* ログを読むとき
*  syslogに対応していない
* データの再配置
*  どのノートにデータが有るか不明
*  しかも分割されている

* riak clusterの周りのシステム
* chefでriakのノードを自動構築
* zabbixで監視
* gangliaで性能データの収集、nagiosへ集約、通知
* logstash -> statsd -> graphite
* elasticsearch -> kibana

* chef
* raid 0で構築しているのでOSが壊れる前提
* 手順の共有のためにも
* gitlabにコードをupしレビューしている

* gangliaによる性能監視
* pythonで拡張し、riakについても監視
* コミュニティーにあるコードを使った

* nagios連携
* 1、2番目くらいに苦労した
* nagiosがgangliaに繁盛にアクセスするためgangliaがカフカに
* rrdtoolがioを大量に発生-> メモリへ

* logstash
* ログも分散しているので
* 諸事情によりfluentdでは無い
* pythonなので他のシステムと連携しやすい、他のシステムでつかってるとな

* elasticsearch
* スケールアウトする検索エンジン
* web uiとしてkibana
* 開発母体が一緒

* 分散システム管理の課題
* 手順書からコードへ
* 管理システムのスケールアウト

* hyper-vリプリか
* 管理スステムのdr
* hyper-v上のcentosで管理システムが稼働している
* 東京と北九州間でレプリカしてる

* mdcについては検討中
* awsのiamのような、
* cloud berry、windowsで動くバックアップソフト
* グループアカウント


## ハンズオン

* 1/15まで使えるよ。
* riakはこの場限りですが。。。

## basho japanより篠原さん

* memcached
* redis
* casandra
* riak

* データをなくさない
* 何時でも読み書き可能
* 運用が楽

* riakソースコードリーディング

* riack ring

* acidを捨てているのでアプリケーション側が難しくなる
* vector clocks　論理時計
